<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Basic Tree - jQuery EasyUI Demo</title>
<link rel="stylesheet" type="text/css" href="easyui/easyui.css">
<link rel="stylesheet" type="text/css" href="easyui/icon.css">
<link rel="stylesheet" type="text/css" href="easyui/demo.css">
<script type="text/javascript" src="easyui/jquery.min.js"></script>
<script type="text/javascript" src="easyui/jquery.easyui.min.js"></script>
</head>
<body>
	<div style="margin:20px 0 10px 0;">
		<a href="#" class="easyui-linkbutton" onclick="javascript:addMenu()">添加菜单</a>
		<a href="#" class="easyui-linkbutton" onclick="javascript:deleteMenu()">删除菜单</a>
	</div>
	<div class="easyui-panel" title="添加菜单" style="width:400px;">
		<div style="margin-bottom:5px">
			<div>菜单名称</div>
			<input class="easyui-textbox" id="menuName" style="width:100%;height:32px">
		</div>
		<div style="margin-bottom:5px">
			<div>URL</div>
			<input class="easyui-textbox" id="menuUrl" style="width:100%;height:32px">
		</div>
	</div>
	<h2>菜单管理</h2>
	<div style="margin: 20px 0;"></div>
	<div class="easyui-panel" style="padding: 5px">
		<ul id="menu" class="easyui-tree" data-options="animate:true,lines:true" th:each="parentMenu:${menu}">
			<li data-options="state:'closed'" >
				<span th:text="${parentMenu.name}"></span>
				<ul>
					<li th:each="childMenu:${parentMenu.childMenus}">
						<span th:text="${childMenu.name}"></span>
					</li>
				</ul>
			</li>
		</ul>
	</div>
</body>
<script type="text/javascript">
	function addMenu(){
		var node = $("#menu").tree("getSelected");
		parentMenu = node.text;
		menuName = $("#menuName")[0].value;
		menuUrl = $("#menuUrl")[0].value;
		if(node.domId == "_easyui_tree_2"){
			alert("请在主菜单下添加菜单");
			return false;
		}
		
		$.ajax({
			url : "menu/addMenu",
			method : "get",
			dataType : "json",
			data :{
				"parentMenu" : parentMenu,
				"menuName" : menuName,
				"menuUrl" : menuUrl
			},
			success : function(res){
				if(res.code == 1){
					alert("添加成功");
				}else{
					alert("添加失败");
				}
			}
		})
	}
</script>
</html>